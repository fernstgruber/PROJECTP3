---
title: "First take on soil function evaluation of Ueberetsch"
author: "fabian gruber"
date: "January 31, 2018"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
require(e1071)
require(RCurl)
require(repmis)
require(randomForest)
require(rgdal)
require(knitr)
proj3path="/home/fabs/PROJECTP3"
setwd(paste(proj3path,"/data/",sep=""))
load(file=paste(proj3path, "/data/preppeddata.RData",sep=""))
dependentlist=names(preppeddata)[36:50]
dependentlist_eng <- c("1a.2.1 - Potential as a habitat for drought-tolerant species",
                       "1a.2.2 - Potential as a habitat for moisture-tolerant species",
                       "1a.3 - Habitat for soil organisms",
                       "1a.4 - Habitat for crops",
                       "1c.1 - Average precipitation retention capacity",
                       "1c.1 - Minimum precipitation retention capacity",
                       "1c.2 - Retention capacity for heavy precipitation events",
                       "1c.3 - groundwater reformation rate",
                       "1c.4 - Potential for providing nutrients for plants",
                       "1c.5 - Potential as a CO2 sink",
                       "1d.1 - Potential for retention of heavy metals",
                       "1d.2 - Potential for transforming organic contaminants",
                       "1d.3 - Potential as filter and buffer for organic contaminants",
                       "1d.4 - Potential for retention of water-soluble contaminants",
                       "1d.5 - Potential as buffer for acidic contaminants")              
myfunctions <- getURL("https://raw.githubusercontent.com/fernstgruber/Rstuff/master/fabiansandrossitersfunctions.R", ssl.verifypeer = FALSE)
eval(parse(text = myfunctions))
for (i in dependentlist){
  preppeddata[[i]] <- factor(preppeddata[[i]],levels=1:5)
  }
  
```

## Soil functions
1 = high potential, 5 = low potential  

   ![Overview of points in the study area.](/home/fabs/PROJECTP3/maps/pointoverviewforrmd.png)

### Habitat for animals and plants  
1a.2.1 - Potential as a habitat for drought-tolerant species:  
```{r,echo=F}
tbl <- table(preppeddata[dependentlist[1]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[1])
```

1a.2.2 - Potential as a habitat for moisture-tolerant species  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[2]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[2])
```

   ![Overview of points in the study area.](/home/fabs/PROJECTP3/maps/pointoverviewforrmd.png)
   
1a.3 - Habitat for soil organisms  
```{r,echo=F}
tbl <- table(preppeddata[dependentlist[3]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[3])
```

   ![Overview of points in the study area.](/home/fabs/PROJECTP3/maps/pointoverviewforrmd.png)
   
1a.4 - Habitat for crops  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[4]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[4])
```

   ![Overview of points in the study area.](/home/fabs/PROJECTP3/maps/pointoverviewforrmd.png)

### Infiltration and drainage regulation  
1c.1 - Precipitation retention capacity  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[5]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[5])
```


```{r,echo=F}
tbl <- table(preppeddata[dependentlist[6]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[6])
```


1c.2 - Retention capacity for heavy precipitation events  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[7]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[7])
```


1c.3 - groundwater reformation rate  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[8]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[8])
```

### Natural soil fertility  
1c.4 - Potential for providing nutrients for plants  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[9]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[9])
```

### Filter and buffer for pollutants

1c.5 - Potential as a CO2 sink  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[10]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[10])
```

1d.1 - Potential for retention of heavy metals  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[11]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[11])
```

1d.2 - Potential for transforming organic contaminants  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[12]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[12])
```


1d.3 - Potential as filter and buffer for organic contaminants  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[13]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[13])
```

1d.4 - Potential for retention of water-soluble contaminants  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[14]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[14])
```


1d.5 - Potential as buffer for acidic contaminants  

```{r,echo=F}
tbl <- table(preppeddata[dependentlist[15]])
barplot(tbl, ylim=c(0,100), main=dependentlist_eng[15])
```

 