require(randomForest)
require(rgdal)
myfunctions <- getURL("https://raw.githubusercontent.com/fernstgruber/Rstuff/master/fabiansandrossitersfunctions.R", ssl.verifypeer = FALSE)
eval(parse(text = myfunctions))
#proj3path="/home/fabs/PROJECTP3"
proj3path="/media/fabs/Volume/01_PAPERZEUG/PROJECTP3/"
#setwd(proj3path)
load('../data/dependentlists.RData')
i=1
filelist=c("../temporlarge/geom_10m_fl4_L9_Leben_Tr.RData","../temporlarge/geom_10m_fl4_L10_et_slope_DTM_50m_avg_ws7_Leben_Tr.RData","../temporlarge/geom_dtm_10m_hyd_fl5_L10_et_minic_ws9_hr_Leben_Tr.RData")
f=filelist[2]
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
}
View(newmodeldatawithpreds)
View(newmodeldatawithpreds[,1:103])
View(newmodeldatawithpreds[,])
View(newmodeldatawithpreds[,5:103])
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
1:nrow(newmodeldatawithpreds)
r=1
vect <- paste(as.integer(newmodeldatawithpreds[r,startn:ncols]))
vect <- as.integer(vect)
vect
Modus(r)
startn:ncolx
startn:ncols
newmodeldatawithpreds[1,]
as.integer(newmodeldatawithpreds[r,startn:ncols])
vect <- paste(as.factor(newmodeldatawithpreds[r,startn:ncols],levels=1:5))
vect <- paste(factor(newmodeldatawithpreds[r,startn:ncols],levels=1:5))
vect
factor(newmodeldatawithpreds[r,startn:ncols],levels=1:5)
factor(newmodeldatawithpreds[1,startn:ncols],levels=1:5)
newmodeldata[1,]
newmodeldatawithpreds[1,]
r=1
vect <- paste(newmodeldatawithpreds[r,startn:ncols])
vec2RGB()
vect
r
newmodeldatawithpreds[1,]
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
f
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
}
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
1:nrow(newmodeldatawithpreds)
vect <- paste(newmodeldatawithpreds[r,startn:ncols])
newmodeldatawithpreds[1,]
r=1
vect <- paste(newmodeldatawithpreds[r,startn:ncols])
vect
View(newmodeldatawithpreds)
r=1
newmodeldatawithpreds[r,startn:ncols]
newmodeldatawithpreds[r,startn:ncols]
newmodeldatawithpreds[1,startn:ncols]
vect <- paste(newmodeldatawithpreds[r,startn:ncols])
vect
str(newmodeldatawithpreds)
startn
startn:ncols
c(startn:ncols)
vect <- paste(newmodeldatawithpreds[r,c(startn:ncols)])
vect <- as.integer(vect)
vect
vect <- paste(newmodeldatawithpreds[r,c(startn:ncols)])
vect
r
head(newmodeldatawithpreds)
head(newmodeldatawithpreds)
r
newmodeldatawithpreds[r
])
newmodeldatawithpreds[r,
])
newmodeldatawithpreds[r,
]
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
vect <- as.integer(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
vect
vect
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
vect
vect <- as.integer(vect)
vect
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
vect
vect
vect
str(vect)
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
vect
str(vect)
Modus(vect)
for (r in 1:nrow(newmodeldatawithpreds)){
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
#vect <- as.integer(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
}
View(newmodeldatawithpreds)
newmodeldatawithpreds
vect <- paste(newmodeldatawithpreds[r,c(startn:ncols)])
str(vect)
vect <- paste(as.character(newmodeldatawithpreds[r,c(startn:ncols)]))
str(vect)
vect <- newmodeldatawithpreds[r,c(startn:ncols)])
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
vect
vect <- as.character(vect)
vect
levels(newmodeldatawithpreds[1,])
str(newmodeldatawithpreds)
knitr::opts_chunk$set(echo = TRUE)
require(e1071)
require(RCurl)
require(repmis)
require(randomForest)
require(rgdal)
myfunctions <- getURL("https://raw.githubusercontent.com/fernstgruber/Rstuff/master/fabiansandrossitersfunctions.R", ssl.verifypeer = FALSE)
eval(parse(text = myfunctions))
#proj3path="/home/fabs/PROJECTP3"
proj3path="/media/fabs/Volume/01_PAPERZEUG/PROJECTP3/"
#setwd(proj3path)
load('../data/dependentlists.RData')
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
}
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
str(newmodeldatawithpreds)
knitr::opts_chunk$set(echo = TRUE)
require(e1071)
require(RCurl)
require(repmis)
require(randomForest)
require(rgdal)
myfunctions <- getURL("https://raw.githubusercontent.com/fernstgruber/Rstuff/master/fabiansandrossitersfunctions.R", ssl.verifypeer = FALSE)
eval(parse(text = myfunctions))
#proj3path="/home/fabs/PROJECTP3"
proj3path="/media/fabs/Volume/01_PAPERZEUG/PROJECTP3/"
#setwd(proj3path)
load('../data/dependentlists.RData')
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
newmodeldatawithpreds[[colname]] <- factor(newmodeldatawithpreds[[colname]],levels=1:5)
}
str(newmodeldatawithpreds)
summary(newmodeldatawithpreds)
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
r=1
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
str(vect)
Modus(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
for (r in 1:nrow(newmodeldatawithpreds)){
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
#vect <- as.character(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
}
summary(newmodeldatawithpreds)
newmodeldatawithpreds
knitr::opts_chunk$set(echo = TRUE)
require(e1071)
require(RCurl)
require(repmis)
require(randomForest)
require(rgdal)
myfunctions <- getURL("https://raw.githubusercontent.com/fernstgruber/Rstuff/master/fabiansandrossitersfunctions.R", ssl.verifypeer = FALSE)
eval(parse(text = myfunctions))
#proj3path="/home/fabs/PROJECTP3"
proj3path="/media/fabs/Volume/01_PAPERZEUG/PROJECTP3/"
#setwd(proj3path)
load('../data/dependentlists.RData')
i=1
filelist=c("../temporlarge/geom_10m_fl4_L9_Leben_Tr.RData","../temporlarge/geom_10m_fl4_L10_et_slope_DTM_50m_avg_ws7_Leben_Tr.RData","../temporlarge/geom_dtm_10m_hyd_fl5_L10_et_minic_ws9_hr_Leben_Tr.RData")
f=filelist[2]
for(f in filelist){
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
newmodeldatawithpreds[[colname]] <- factor(newmodeldatawithpreds[[colname]],levels=1:5)
}
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
r=1
for (r in 1:nrow(newmodeldatawithpreds)){
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
#vect <- as.character(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
}
boxplot(cvaccs)
print(paste("mean accuracy = " , mean(cvaccs)))
print(paste("median accuracy = " , median(cvaccs)))
print("confusion table for mode of 100 predicitions")
print(table(newmodeldatawithpreds[[dep]],newmodeldatawithpreds[["moderesult"]]) )
print(mean(newmodeldatawithpreds[[dep]] == newmodeldatawithpreds[["moderesult"]]))
rm(modeldata,preddata,CM,hist,fit)
}
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
newmodeldatawithpreds[[colname]] <- factor(newmodeldatawithpreds[[colname]],levels=1:5)
}
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
r=1
for (r in 1:nrow(newmodeldatawithpreds)){
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
#vect <- as.character(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
}
boxplot(cvaccs)
print(paste("mean accuracy = " , mean(cvaccs)))
print(paste("median accuracy = " , median(cvaccs)))
print("confusion table for mode of 100 predicitions")
print(table(newmodeldatawithpreds[[dep]],newmodeldatawithpreds[["moderesult"]]) )
print(mean(newmodeldatawithpreds[[dep]] == newmodeldatawithpreds[["moderesult"]]))
summary(newmodeldatawithpreds)
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
for(f in filelist){
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
newmodeldatawithpreds[[colname]] <- factor(newmodeldatawithpreds[[colname]],levels=1:5)
}
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
r=1
for (r in 1:nrow(newmodeldatawithpreds)){
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
#vect <- as.character(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
}
newmodeldatawithpreds[[dep]] <- factor(newmodeldatawithpreds,levels = 1:5)
boxplot(cvaccs)
print(paste("mean accuracy = " , mean(cvaccs)))
print(paste("median accuracy = " , median(cvaccs)))
print("confusion table for mode of 100 predicitions")
print(table(newmodeldatawithpreds[[dep]],newmodeldatawithpreds[["moderesult"]]) )
print(mean(newmodeldatawithpreds[[dep]] == newmodeldatawithpreds[["moderesult"]]))
rm(modeldata,preddata,CM,hist,fit)
}
i=2
filelist=c("../temporlarge/geom_10m_fl10_L70_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/geom_10m_fl10_L70_et_CrossSectionalCurvature_hr_Leben_Fe.RData","../temporlarge/Longitudinal_Curvature_hr_et_geom_10m_fl10_L70_Leben_Fe.RData")
f=filelist[1]
for(f in filelist){
dep=dependentlist[i]
print(dependentlist_eng[i])
load(paste("../data/modeldata/SVMorigmodeldatawithgeoandgeom_",dep,".RData",sep=""))
load(file=f)
print(f)
print(paste("10fold cross-validated accuracy from main modelrunf: ",fit$tot.accuracy))
print(paste("original distribution: "))
print(table(modeldata[dependent]))
print(paste("predicted distribution of soil pit sites"))
print(table(modeldata["preds"]))
print(paste("confusion matrix"))
print(CM)
print(paste("predicted distribution of study area"))
print(hist)
print("what happens when CV is performed a 100 times")
cvaccs=vector()
newmodeldata = modeldata[!(names(modeldata) %in% c("preds"))]
newmodeldatawithpreds=newmodeldata
t=1
for (t in 1:100){
set.seed(t)
f <- paste(dep,"~.")
fit <- do.call("svm",list(as.formula(f),modeldata,cross=10))
cvaccs[t] = fit$tot.accuracy
colname=paste("predseed_",t,sep="")
newmodeldatawithpreds[[colname]] <- predict(fit,newdata=modeldata)
newmodeldatawithpreds[[colname]] <- factor(newmodeldatawithpreds[[colname]],levels=1:5)
}
ncols <- ncol(newmodeldatawithpreds)
startn = ncols-99
r=1
for (r in 1:nrow(newmodeldatawithpreds)){
vect <- newmodeldatawithpreds[r,c(startn:ncols)]
#vect <- as.character(vect)
newmodeldatawithpreds[r,"moderesult"] <- Modus(vect)
}
newmodeldatawithpreds[[dep]] <- factor(newmodeldatawithpreds[[dep]],levels = 1:5)
boxplot(cvaccs)
print(paste("mean accuracy = " , mean(cvaccs)))
print(paste("median accuracy = " , median(cvaccs)))
print("confusion table for mode of 100 predicitions")
print(table(newmodeldatawithpreds[[dep]],newmodeldatawithpreds[["moderesult"]]) )
print(mean(newmodeldatawithpreds[[dep]] == newmodeldatawithpreds[["moderesult"]]))
rm(modeldata,preddata,CM,hist,fit)
}
